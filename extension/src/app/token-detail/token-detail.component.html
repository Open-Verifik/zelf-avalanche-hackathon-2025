<div class="zelf-card token-detail" *transloco="let t">
    <div class="token-detail__header">
        <div class="token-detail__col1">
            <button
                (click)="removeAsset()"
                [routerLink]="['/home']"
                class="zelf-icon-button zelf-icon-button--40 zelf-icon-button--anti-flash-white zelf-icon-button--40"
                mat-flat-button
            >
                <svg width="22" height="14" viewBox="0 0 22 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M20.0898 5.8277H4.72478L8.08478 2.4677C8.53978 2.0127 8.53978 1.2777 8.08478 0.822695C7.62978 0.367695 6.89478 0.367695 6.43978 0.822695L1.08478 6.1777C0.62978 6.6327 0.62978 7.3677 1.08478 7.8227L6.43978 13.1777C6.89478 13.6327 7.62978 13.6327 8.08478 13.1777C8.53978 12.7227 8.53978 11.9877 8.08478 11.5327L4.72478 8.16103H20.0898C20.7314 8.16103 21.2564 7.63603 21.2564 6.99436C21.2564 6.3527 20.7314 5.8277 20.0898 5.8277Z"
                    />
                </svg>
            </button>
        </div>

        <div class="token-detail__col2">
            <p class="token-detail__title" *ngIf="!loading">{{ asset.network }}</p>
        </div>

        <div class="token-detail__col3"></div>
    </div>

    <ng-container *ngIf="!loading">
        <div class="zelf-card__content token-detail__content">
            <div class="zelf-chip token-detail__chip">
                <img [src]="asset.image" alt="icon" class="zelf-chip__image" />

                {{ t("common.your_token", { symbol: asset.symbol }) }}
            </div>

            <h3 class="token-detail__amount">{{ asset.amount | number: "1.1-8" }} {{ asset.symbol }}</h3>

            <p class="token-detail__price">{{ asset.price | currency: "USD" : "symbol" : "1.2-5" }}</p>

            <div class="token-detail__intervals">
                <p class="token-detail__interval-label">{{ t("token.price_detail") }}</p>

                <div
                    (click)="changeRange(interval.range)"
                    [ngClass]="{ 'token-detail__interval--active': interval.range === selectedRange }"
                    *ngFor="let interval of intervals"
                    class="token-detail__interval"
                >
                    <p class="token-detail__interval-title">{{ interval.label }}</p>
                </div>
            </div>

            <div class="chart-box">
                <img [src]="asset.image" alt="icon" class="chart-box__image" />

                <div class="chart-box__inner">
                    <div class="chart-box__left">
                        <ng-container *ngIf="!loadingDetails && details">
                            <h5 class="chart-box__fiat">{{ details.price.price | currency: "USD" : "symbol" : "1.2-4" }}</h5>

                            <div class="chart-box__lower">
                                <p class="chart-box__percentage">{{ priceChangeToken | number: "1.1-3" }} {{ details.about.symbol }}</p>

                                <p
                                    class="diff-chip"
                                    [ngClass]="{
                                        'diff-chip--positive': priceChangePercentage > 0,
                                        'diff-chip--negative': priceChangePercentage < 0,
                                        'diff-chip--neutral': priceChangePercentage === 0,
                                    }"
                                >
                                    {{ priceChangePercentage | number: "1.2-2" }} %
                                </p>
                            </div>
                        </ng-container>
                    </div>

                    <zelf-loader [diameter]="40" *ngIf="loadingChart"></zelf-loader>

                    <div class="chart-box__right" #chartContainer [class.hidden]="!chartData"></div>
                    <div class="chart-box__right" [class.hidden]="loadingChart || chartData">
                        <p class="chart-box__percentage">{{ t("errors.chart_not_found") }}</p>
                    </div>
                </div>
            </div>

            <div class="token-detail__actions" fxLayout="row" fxLayoutAlign="center center">
                <div class="token-actions">
                    <div class="token-actions__icon" [routerLink]="['/receive', 'qr', asset.network]">
                        <div class="token-actions__icon-box">
                            <svg width="17" height="18" viewBox="0 0 17 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M16.6755 0.834414C16.2205 0.379414 15.4855 0.379414 15.0305 0.834414L2.32552 13.5277V7.00608C2.32552 6.36441 1.80052 5.83941 1.15885 5.83941C0.517187 5.83941 -0.0078125 6.36441 -0.0078125 7.00608V16.3394C-0.0078125 16.9811 0.517187 17.5061 1.15885 17.5061H10.4922C11.1339 17.5061 11.6589 16.9811 11.6589 16.3394C11.6589 15.6977 11.1339 15.1727 10.4922 15.1727H3.97052L16.6755 2.46775C17.1189 2.02441 17.1189 1.27775 16.6755 0.834414Z"
                                />
                            </svg>
                        </div>
                    </div>

                    <div class="token-actions__text">{{ t("home.receive_transaction_button") }}</div>
                </div>

                <div class="token-actions" *ngIf="checkCanSend()">
                    <div (click)="prepareSend()" class="token-actions__icon">
                        <div class="token-actions__icon-box">
                            <svg width="19" height="18" viewBox="0 0 19 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M6.34571 1.65397C6.34571 2.3073 6.87071 2.82064 7.51238 2.82064H14.034L1.32904 15.5256C0.874043 15.9806 0.874043 16.7156 1.32904 17.1706C1.78404 17.6256 2.51904 17.6256 2.97404 17.1706L15.679 4.46564V10.9873C15.679 11.629 16.204 12.154 16.8457 12.154C17.4874 12.154 18.0124 11.629 18.0124 10.9873V1.65397C18.0124 1.0123 17.4874 0.487305 16.8457 0.487305H7.51238C6.87071 0.487305 6.34571 1.0123 6.34571 1.65397Z"
                                />
                            </svg>
                        </div>
                    </div>

                    <div class="token-actions__text cursor-pointer">{{ t("home.send_transaction_button") }}</div>
                </div>

                <div class="token-actions" *ngIf="false && checkCanSwap()">
                    <div class="token-actions__icon" [routerLink]="['/swap']">
                        <div class="token-actions__icon-box">
                            <svg width="24" height="19" viewBox="0 0 18 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M3.13563 6.85496L0.355635 9.64496C0.165635 9.84496 0.165635 10.155 0.355635 10.355L3.13563 13.145C3.44563 13.465 3.98563 13.235 3.98563 12.795V10.995H9.99564C10.5456 10.995 10.9956 10.545 10.9956 9.99496C10.9956 9.44496 10.5456 8.99496 9.99564 8.99496H3.98563V7.20496C3.98563 6.75496 3.44563 6.53496 3.13563 6.85496ZM17.6456 3.64496L14.8656 0.854961C14.5556 0.534961 14.0156 0.764961 14.0156 1.20496V2.99496H7.99564C7.44563 2.99496 6.99564 3.44496 6.99564 3.99496C6.99564 4.54496 7.44563 4.99496 7.99564 4.99496H14.0056V6.78496C14.0056 7.23496 14.5456 7.45496 14.8556 7.13496L17.6356 4.34496C17.8356 4.15496 17.8356 3.83496 17.6456 3.64496Z"
                                />
                            </svg>
                        </div>
                    </div>

                    <div class="token-actions__text cursor-pointer">{{ t("home.swap") }}</div>
                </div>
            </div>

            <div class="token-detail__tabs">
                <div class="animated-tabs">
                    <div
                        class="animated-tabs__switch"
                        [ngClass]="{
                            'animated-tabs__switch--left': selectedTab === 'about',
                            'animated-tabs__switch--right': selectedTab === 'history',
                        }"
                    >
                        <div (click)="selectTab('about')" [ngClass]="{ 'animated-tab--active': selectedTab === 'about' }" class="animated-tab">
                            <span>{{ t("common.about") }}</span>
                        </div>

                        <div (click)="selectTab('history')" [ngClass]="{ 'animated-tab--active': selectedTab === 'history' }" class="animated-tab">
                            <span>{{ t("common.history") }}</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="token-detail__tab-content">
                <zelf-loader *ngIf="!loading && loadingDetails"></zelf-loader>

                <ng-container *ngIf="!loadingDetails && details && selectedTab === 'about'">
                    <h5 class="token-about__title">{{ t("token.about", { network: details.about.network }) }}</h5>

                    <div class="zelf-action-row">
                        <p class="zelf-action-row__label">{{ t("common.symbol") }}</p>
                        <p class="zelf-action-row__value">{{ details.about.symbol || asset.symbol }}</p>
                    </div>

                    <div class="zelf-action-row">
                        <p class="zelf-action-row__label">{{ t("common.network") }}</p>
                        <p class="zelf-action-row__value">{{ details.about.network || asset.network }}</p>
                    </div>

                    <div class="zelf-action-row token-about__description-row" *ngIf="details.about.description">
                        <div class="token-about__description-container">
                            <p
                                class="token-about__description"
                                [ngClass]="readMore ? 'token-about__description--expand' : ''"
                                [innerHTML]="details.about.description | safeHtml"
                            >
                                {{ details.about.description }}
                            </p>

                            <span (click)="readMore = true" class="token-about__show-more" *ngIf="!readMore">{{ t("common.show_more") }}</span>
                            <span (click)="readMore = false" class="token-about__show-more" *ngIf="readMore">{{ t("common.show_less") }}</span>
                        </div>

                        <div class="token-about__buttons">
                            <button
                                [queryParams]="{ externalUrl: details.about.urls.website[0] || '' }"
                                [routerLink]="['/external-link']"
                                *ngIf="details.about.urls.website.length > 0"
                                class="zelf-button zelf-button--hyperlink token-about__website-button"
                                mat-flat-button
                            >
                                <svg xmlns="http://www.w3.org/2000/svg" height="20px" width="20px" viewBox="0 -960 960 960">
                                    <path
                                        d="M480-80q-82 0-155-31.5t-127.5-86Q143-252 111.5-325T80-480q0-83 31.5-155.5t86-127Q252-817 325-848.5T480-880q83 0 155.5 31.5t127 86q54.5 54.5 86 127T880-480q0 82-31.5 155t-86 127.5q-54.5 54.5-127 86T480-80Zm0-82q26-36 45-75t31-83H404q12 44 31 83t45 75Zm-104-16q-18-33-31.5-68.5T322-320H204q29 50 72.5 87t99.5 55Zm208 0q56-18 99.5-55t72.5-87H638q-9 38-22.5 73.5T584-178ZM170-400h136q-3-20-4.5-39.5T300-480q0-21 1.5-40.5T306-560H170q-5 20-7.5 39.5T160-480q0 21 2.5 40.5T170-400Zm216 0h188q3-20 4.5-39.5T580-480q0-21-1.5-40.5T574-560H386q-3 20-4.5 39.5T380-480q0 21 1.5 40.5T386-400Zm268 0h136q5-20 7.5-39.5T800-480q0-21-2.5-40.5T790-560H654q3 20 4.5 39.5T660-480q0 21-1.5 40.5T654-400Zm-16-240h118q-29-50-72.5-87T584-782q18 33 31.5 68.5T638-640Zm-234 0h152q-12-44-31-83t-45-75q-26 36-45 75t-31 83Zm-200 0h118q9-38 22.5-73.5T376-782q-56 18-99.5 55T204-640Z"
                                    />
                                </svg>
                                {{ t("common.website") }}
                            </button>

                            <button
                                [queryParams]="{ externalUrl: details.about.urls.twitter[0] }"
                                [routerLink]="['/external-link']"
                                *ngIf="details.about.urls.twitter.length > 0"
                                class="zelf-icon-button zelf-icon-button--40 zelf-icon-button--hyperlink"
                                mat-flat-button
                            >
                                <svg xmlns="http://www.w3.org/2000/svg" height="20px" width="20px" viewBox="0 0 512 512">
                                    <path
                                        d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"
                                    />
                                </svg>
                            </button>

                            <button
                                [queryParams]="{ externalUrl: details.about.urls.reddit[0] }"
                                [routerLink]="['/external-link']"
                                *ngIf="details.about.urls.reddit.length > 0"
                                class="zelf-icon-button zelf-icon-button--40 zelf-icon-button--hyperlink"
                                mat-flat-button
                            >
                                <svg xmlns="http://www.w3.org/2000/svg" height="20px" width="20px" viewBox="0 0 512 512">
                                    <path
                                        d="M373 138.6c-25.2 0-46.3-17.5-51.9-41l0 0c-30.6 4.3-54.2 30.7-54.2 62.4l0 .2c47.4 1.8 90.6 15.1 124.9 36.3c12.6-9.7 28.4-15.5 45.5-15.5c41.3 0 74.7 33.4 74.7 74.7c0 29.8-17.4 55.5-42.7 67.5c-2.4 86.8-97 156.6-213.2 156.6S45.5 410.1 43 323.4C17.6 311.5 0 285.7 0 255.7c0-41.3 33.4-74.7 74.7-74.7c17.2 0 33 5.8 45.7 15.6c34-21.1 76.8-34.4 123.7-36.4l0-.3c0-44.3 33.7-80.9 76.8-85.5C325.8 50.2 347.2 32 373 32c29.4 0 53.3 23.9 53.3 53.3s-23.9 53.3-53.3 53.3zM157.5 255.3c-20.9 0-38.9 20.8-40.2 47.9s17.1 38.1 38 38.1s36.6-9.8 37.8-36.9s-14.7-49.1-35.7-49.1zM395 303.1c-1.2-27.1-19.2-47.9-40.2-47.9s-36.9 22-35.7 49.1c1.2 27.1 16.9 36.9 37.8 36.9s39.3-11 38-38.1zm-60.1 70.8c1.5-3.6-1-7.7-4.9-8.1c-23-2.3-47.9-3.6-73.8-3.6s-50.8 1.3-73.8 3.6c-3.9 .4-6.4 4.5-4.9 8.1c12.9 30.8 43.3 52.4 78.7 52.4s65.8-21.6 78.7-52.4z"
                                    />
                                </svg>
                            </button>

                            <button
                                [queryParams]="{ externalUrl: details.about.urls.source_code[0] }"
                                [routerLink]="['/external-link']"
                                *ngIf="details.about.urls.source_code.length > 0"
                                class="zelf-icon-button zelf-icon-button--40 zelf-icon-button--hyperlink"
                                mat-flat-button
                            >
                                <svg xmlns="http://www.w3.org/2000/svg" height="20px" width="20px" viewBox="0 -960 960 960">
                                    <path
                                        d="M320-240 80-480l240-240 57 57-184 184 183 183-56 56Zm320 0-57-57 184-184-183-183 56-56 240 240-240 240Z"
                                    />
                                </svg>
                            </button>

                            <button
                                [queryParams]="{ externalUrl: details.about.urls.technical_doc[0] }"
                                [routerLink]="['/external-link']"
                                *ngIf="details.about.urls.technical_doc.length > 0"
                                class="zelf-icon-button zelf-icon-button--40 zelf-icon-button--hyperlink"
                                mat-flat-button
                            >
                                <svg xmlns="http://www.w3.org/2000/svg" height="20px" width="20px" viewBox="0 -960 960 960">
                                    <path
                                        d="M320-160q-33 0-56.5-23.5T240-240v-120h120v-90q-35-2-66.5-15.5T236-506v-44h-46L60-680q36-46 89-65t107-19q27 0 52.5 4t51.5 15v-55h480v520q0 50-35 85t-85 35H320Zm120-200h240v80q0 17 11.5 28.5T720-240q17 0 28.5-11.5T760-280v-440H440v24l240 240v56h-56L510-514l-8 8q-14 14-29.5 25T440-464v104ZM224-630h92v86q12 8 25 11t27 3q23 0 41.5-7t36.5-25l8-8-56-56q-29-29-65-43.5T256-684q-20 0-38 3t-36 9l42 42Zm376 350H320v40h286q-3-9-4.5-19t-1.5-21Zm-280 40v-40 40Z"
                                    />
                                </svg>
                            </button>
                        </div>
                    </div>

                    <h5 class="token-about__title">{{ t("common.information") }}</h5>

                    <div class="token-about__action-rows">
                        <div class="zelf-action-row zelf-action-row--column zelf-action-row--flex-50 token-about__description-row">
                            <p class="zelf-action-row__label">{{ t("token.market_cap") }}</p>
                            <p class="zelf-action-row__value token-about__cap-menda">
                                {{ details.about.information.marketCap | truncateNumber }} USD$
                            </p>
                            <p
                                class="diff-chip"
                                [ngClass]="{
                                    'diff-chip--positive': details.about.information.marketCapChangePercentage24h > 0,
                                    'diff-chip--negative': details.about.information.marketCapChangePercentage24h < 0,
                                    'diff-chip--neutral': details.about.information.marketCapChangePercentage24h === 0,
                                }"
                            >
                                {{ details.about.information.marketCapChangePercentage24h | number: "1.2" }} %
                            </p>
                        </div>

                        <div class="zelf-action-row zelf-action-row--column zelf-action-row--flex-50 token-about__description-row">
                            <p class="zelf-action-row__label">{{ t("token.volume_24h") }}</p>
                            <p class="zelf-action-row__value token-about__cap-menda">{{ details.about.information.volume | truncateNumber }} USD$</p>
                            <p
                                class="diff-chip"
                                [ngClass]="{
                                    'diff-chip--positive': details.about.information.volumeChangePercentage24h > 0,
                                    'diff-chip--negative': details.about.information.volumeChangePercentage24h < 0,
                                    'diff-chip--neutral': details.about.information.volumeChangePercentage24h === 0,
                                }"
                            >
                                {{ details.about.information.volumeChangePercentage24h | number: "1.2" }} %
                            </p>
                        </div>
                    </div>

                    <div class="zelf-action-row">
                        <p class="zelf-action-row__label">{{ t("token.total_supply") }}</p>
                        <p class="zelf-action-row__value">{{ details.about.information.totalSupply | truncateNumber }} {{ asset.symbol }}</p>
                    </div>

                    <div class="zelf-action-row">
                        <p class="zelf-action-row__label">{{ t("token.circulating_supply") }}</p>
                        <p class="zelf-action-row__value">{{ circulatingSupplyInFiat }}</p>
                    </div>

                    <div class="zelf-action-row">
                        <p class="zelf-action-row__label">{{ t("token.holders") }}</p>
                        <p class="zelf-action-row__value">{{ details.about.information.holders | truncateNumber }}</p>
                    </div>

                    <h5 class="token-about__title">{{ t("token.24h_performance") }}</h5>

                    <div class="zelf-action-row">
                        <p class="zelf-action-row__label">{{ t("token.volume") }}</p>
                        <p class="zelf-action-row__value">{{ details.about.performance24h.volume | truncateNumber }}</p>
                    </div>

                    <div class="zelf-action-row">
                        <p class="zelf-action-row__label">{{ t("token.traders") }}</p>
                        <p class="zelf-action-row__value">{{ details.about.performance24h.traders | truncateNumber }}</p>
                    </div>
                </ng-container>

                <ng-container *ngIf="!loadingDetails && details && selectedTab === 'history'">
                    <zelf-history [token]="this.asset.symbol"></zelf-history>
                </ng-container>
            </div>
        </div>
    </ng-container>
</div>
